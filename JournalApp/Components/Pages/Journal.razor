@page "/journal"
@using JournalApp.Models
@inject JournalApp.Data.AppDatabase Database

<h1>Journal</h1>

<button class="btn btn-primary" @onclick="SaveTodayEntry">
    Save Today's Entry
</button>

<hr />

@if (entries == null)
{
    <p>Loading entries...</p>
}
else if (entries.Count == 0)
{
    <p>No journal entries yet.</p>
}
else
{
    <ul>
        @foreach (var entry in entries)
        {
            <li>
                <strong>@entry.Title</strong>
                <br />
                <small>@entry.CreatedAt</small>
            </li>
            <li>
   
    <button class="btn btn-sm btn-danger"
            @onclick="() => DeleteEntry(entry)">
        Delete
    </button>
</li>
        }
    </ul>
}

@code {
    private List<JournalEntry>? entries;

    protected override async Task OnInitializedAsync()
    {
        entries = await Database.GetEntriesAsync();
    }

    private async Task SaveTodayEntry()
    {
        var today = DateTime.Today;

        await Database.SaveEntryAsync(new JournalEntry
        {
            Title = "Today's Entry",
            Content = "This is today's journal entry.",
            EntryDate = today
        });

        entries = await Database.GetEntriesAsync();
    }
    private async Task DeleteEntry(JournalEntry entry)
{
    await Database.DeleteEntryAsync(entry);
    entries = await Database.GetEntriesAsync();
}

}
